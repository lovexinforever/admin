(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1eb1deff"],{"1da1":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));a("d3b7");function r(e,t,a,r,i,n,s){try{var l=e[n](s),o=l.value}catch(c){return void a(c)}l.done?t(o):Promise.resolve(o).then(r,i)}function i(e){return function(){var t=this,a=arguments;return new Promise((function(i,n){var s=e.apply(t,a);function l(e){r(s,i,n,l,o,"next",e)}function o(e){r(s,i,n,l,o,"throw",e)}l(void 0)}))}}},2909:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("6b75");function i(e){if(Array.isArray(e))return Object(r["a"])(e)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function n(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=a("06c5");function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e){return i(e)||n(e)||Object(s["a"])(e)||l()}},"65b6":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-header-wrapper",[a("a-card",{attrs:{"body-style":{padding:"24px 32px"},bordered:!1}},[a("a-form",{attrs:{form:e.form},on:{submit:e.handleSubmit}},[a("a-form-item",{attrs:{label:"活动名称",labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:17}}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{rules:[{required:!0,message:"请输入活动名称"}]}],expression:"[\n            'title',\n            {rules: [{ required: true, message: '请输入活动名称' }]}\n          ]"}],attrs:{name:"name",placeholder:"活动名称"}})],1),a("a-form-item",{attrs:{label:"活动时间",labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:17}}}},[a("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["time",{rules:[{required:!0,message:"请选择活动时间"}]}],expression:"[\n            'time',\n            {rules: [{ required: true, message: '请选择活动时间' }]}\n          ]"}],staticStyle:{width:"100%"},attrs:{name:"time"}})],1),a("a-form-item",{staticClass:"avatar-uploader-container",attrs:{label:"活动图片",labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:17}}}},[a("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["activityPic",{rules:[{required:!0,message:"请选择活动图片"}]}],expression:"[\n            'activityPic',\n            {rules: [{ required: true, message: '请选择活动图片' }]}\n          ]"}],staticClass:"avatar-uploader",attrs:{name:"avatar","list-type":"picture-card","show-upload-list":!1,action:e.getUploadPic,data:e.getData,headers:{Authorization:"Bearer "+e.token},"before-upload":e.beforeUpload},on:{change:e.handleChange}},[e.activityPic?a("img",{staticClass:"activity-pic",attrs:{src:e.activityPic,alt:"avatar"}}):a("div",[a("a-icon",{attrs:{type:e.loading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v(" 上传 ")])],1)]),a("span",{staticStyle:{color:"grey","line-height":"20px","font-size":"10px"}},[e._v("图片建议尺寸660*200px")])],1),a("a-form-item",{staticClass:"other-container",attrs:{label:"其他图片",labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:17}}}},[a("div",{staticClass:"clearfix"},[a("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["fileList"],expression:"[\n              'fileList'\n            ]"}],attrs:{"list-type":"picture-card","file-list":e.fileList,multiple:"",action:e.getUploadPic,data:e.getData,headers:{Authorization:"Bearer "+e.token}},on:{preview:e.handlePreview,change:e.handleFileListChange}},[e.fileList.length<50?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v(" 上传 ")])],1):e._e()]),a("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1),a("span",{staticStyle:{color:"grey","line-height":"20px","font-size":"10px"}},[e._v("图片建议尺寸750px")])]),a("a-form-item",{attrs:{label:"参与人数",labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:17}}}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["totalNum",{rules:[{required:!0,message:"请输入参与人数"}]}],expression:"[\n            'totalNum',\n            {rules: [{ required: true, message: '请输入参与人数' }]}\n          ]"}],attrs:{min:1,type:"number",name:"totalNum",placeholder:"参与人数"}})],1),a("a-form-item",{attrs:{label:"虚拟报名人数",labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:17}}}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["virtualNum",{rules:[{required:!0,message:"请输入虚拟报名人数"}]}],expression:"[\n            'virtualNum',\n            {rules: [{ required: true, message: '请输入虚拟报名人数' }]}\n          ]"}],attrs:{min:1,placeholder:"虚拟报名人数"}})],1),a("a-form-item",{attrs:{label:"关联大V",labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:17}}}},[a("div",{directives:[{name:"decorator",rawName:"v-decorator",value:["vId",{rules:[{required:!0,message:"请选择大V"}]}],expression:"[\n            'vId',\n            {rules: [{ required: true, message: '请选择大V' }]}\n          ]"}],staticClass:"select-v",attrs:{name:"vId"},on:{click:e.selectVData}},[e._v(e._s(e.vData.name))])]),a("a-form-item",{staticStyle:{"text-align":"center"},attrs:{wrapperCol:{span:24}}},[a("a-button",{attrs:{htmlType:"submit",type:"primary"}},[e._v(e._s(e.$t("form.basic-form.form.submit")))])],1)],1),a("select-v",{attrs:{visible:e.visible,"is-multiple":""},on:{cancel:e.handleSelectVCancel,ok:e.handleSelectVOk}})],1)],1)},i=[],n=a("1da1"),s=a("5530"),l=a("2909"),o=(a("96cf"),a("d3b7"),a("d81d"),a("99af"),a("a754")),c=a("9fb0"),u=a("8ded"),d=a.n(u),p=a("218c"),m=a.n(p),v=a("0fea"),f=a("ca00");function h(e,t){var a=new FileReader;a.addEventListener("load",(function(){return t(a.result)})),a.readAsDataURL(e)}function b(e){return new Promise((function(t,a){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return a(e)}}))}var g={name:"CreateActivity",components:{SelectV:o["a"]},data:function(){return{form:this.$form.createForm(this),vData:{name:""},loading:!1,activityPic:"",visible:!1,previewVisible:!1,previewImage:"",fileList:[],token:d.a.get(c["a"])}},methods:{handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields((function(e,a){if(!e){var r,i,n,o,c,u,d;if(200!==(null===(r=a.activityPic)||void 0===r||null===(i=r.file)||void 0===i||null===(n=i.response)||void 0===n?void 0:n.code))return void m.a.error({message:"图片上传失败, 请重新上传"});var p=parseInt("".concat(a.totalNum)),f=parseInt("".concat(a.virtualNum));if(f>p)return void m.a.error({message:"虚拟报名人数不能大于总人数"});var h={vId:a.vId,title:a.title,startTime:a.time[0].format("YYYY-MM-DD hh:MM:ss"),endTime:a.time[1].format("YYYY-MM-DD hh:MM:ss"),des:a.des,totalNum:p,virtualNum:f,activityPic:null===(o=a.activityPic)||void 0===o||null===(c=o.file)||void 0===c||null===(u=c.response)||void 0===u||null===(d=u.data)||void 0===d?void 0:d.key};if(a.fileList&&a.fileList.fileList){var b=[];a.fileList.fileList.map((function(e,t){var a,r,i;200===(null===e||void 0===e||null===(a=e.response)||void 0===a?void 0:a.code)&&(b=[].concat(Object(l["a"])(b),[null===e||void 0===e||null===(r=e.response)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.key]))})),h=Object(s["a"])(Object(s["a"])({},h),{},{otherPic:b})}Object(v["a"])(h).then((function(e){t.$notification.success({message:"新建成功"}),t.$router.push("/activity/activity-list")}))}}))},selectVData:function(e){e.preventDefault(),this.visible=!0},handleSelectVCancel:function(){this.visible=!1},onEditorChange:function(e){this.form.setFieldsValue({des:e.html})},handleSelectVOk:function(e){this.visible=!1,null!==e&&void 0!==e&&""!==e&&(this.vData=e,this.form.setFieldsValue({vId:e.id}))},handleChange:function(e){var t=this;"uploading"!==e.file.status?"done"===e.file.status&&h(e.file.originFileObj,(function(e){t.activityPic=e,t.loading=!1})):this.loading=!0},beforeUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;return t||this.$message.error("You can only upload JPG file!"),t},getData:function(e){return{file:e}},getBatchData:function(e){return[{file:e}]},handleCancel:function(){this.previewVisible=!1},handlePreview:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,b(e.originFileObj);case 3:e.preview=a.sent;case 4:t.previewImage=e.url||e.preview,t.previewVisible=!0;case 6:case"end":return a.stop()}}),a)})))()},getUploadPic:function(){return Object(f["s"])()},handleFileListChange:function(e){var t=e.fileList;this.fileList=t}}},y=g,w=(a("cc93"),a("2877")),C=Object(w["a"])(y,r,i,!1,null,"4d7070a4",null);t["default"]=C.exports},a754:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"选择大V",width:1200,visible:e.visible,footer:null},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"大V名字"}},[a("a-input",{attrs:{placeholder:""},model:{value:e.queryParam.name,callback:function(t){e.$set(e.queryParam,"name",t)},expression:"queryParam.name"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"手机号"}},[a("a-input",{attrs:{placeholder:""},model:{value:e.queryParam.phone,callback:function(t){e.$set(e.queryParam,"phone",t)},expression:"queryParam.phone"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons",style:{float:"right",overflow:"hidden"}},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")])],1)])],1)],1)],1),this.selectedRowKeys.length>0?a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary"},on:{click:e.selectUser}},[e._v("选择")])],1):e._e(),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"vId",columns:e.columns,data:e.loadData,alert:this.isMultiple?e.options.alert:null,rowSelection:this.isMultiple?e.options.rowSelection:null,showPagination:"auto"},scopedSlots:e._u([{key:"avatar",fn:function(e){return a("span",{},[a("a-avatar",{attrs:{src:e}})],1)}},{key:"action",fn:function(t,r){return a("span",{},[[a("a",{on:{click:function(){e.$emit("ok",Object.assign({},r,{id:r.vId}))}}},[e._v("选择")])]],2)}}])})],1)},i=[],n=a("5530"),s=(a("d81d"),a("b0c0"),a("2af9")),l=a("0fea"),o=[{title:"大V编号",dataIndex:"vId"},{title:"头像",dataIndex:"avatar",scopedSlots:{customRender:"avatar"}},{title:"名字",dataIndex:"name"},{title:"手机号",dataIndex:"phone"},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],c=[{title:"大V编号",dataIndex:"vId"},{title:"头像",dataIndex:"avatar",scopedSlots:{customRender:"avatar"}},{title:"名字",dataIndex:"name"},{title:"手机号",dataIndex:"phone"}],u={props:{visible:{type:Boolean,required:!0},isMultiple:{type:Boolean},selectKeys:{type:Array,default:function(){return[]}},selectRows:{type:Array,default:function(){return[]}}},components:{STable:s["c"]},methods:{onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},selectUser:function(){var e="",t="";this.selectedRows.map((function(a){e+=a.vId+",",t+=a.name+","})),e=e.substring(0,e.length-1),t=t.substring(0,t.length-1),this.$emit("ok",{name:t,id:e})}},data:function(){var e=this;return this.columns=this.isMultiple?c:o,{queryParam:{},selectedRowKeys:this.selectKeys,selectedRows:this.selectRows,options:{alert:{show:!0,clear:function(){e.selectedRowKeys=[]}},rowSelection:{selectedRowKeys:this.selectKeys,onChange:this.onSelectChange}},optionAlertShow:!1,loadData:function(t){var a=Object.assign({},t,e.queryParam);return Object(l["eb"])(a).then((function(e){return Object(n["a"])(Object(n["a"])({},e.data),{},{page:a.page})}))}}},created:function(){}},d=u,p=a("2877"),m=Object(p["a"])(d,r,i,!1,null,null,null);t["a"]=m.exports},ac20:function(e,t,a){},cc93:function(e,t,a){"use strict";a("ac20")}}]);