"use strict";(self["webpackChunkvue_antd_pro"]=self["webpackChunkvue_antd_pro"]||[]).push([[700],{88700:function(t,e,a){a.r(e),a.d(e,{default:function(){return C}});a(68309);var i=function(){var t=this,e=t._self._c;return e("page-header-wrapper",[e("a-card",{attrs:{bordered:!1}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:48}},[e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"姓名/电话"}},[e("a-input",{attrs:{placeholder:"请输入姓名/电话",allowClear:""},model:{value:t.queryParam.name,callback:function(e){t.$set(t.queryParam,"name",e)},expression:"queryParam.name"}})],1)],1),t.permissionCustomView?e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"归属员工"}},[e("div",{staticClass:"select-v ant-input-affix-wrapper",class:{placeholder:!t.getStaffName},on:{click:t.selectStaff}},[t._v(t._s(t.getStaffName?t.getStaffName:"请选择")+" "),e("span",{staticClass:"ant-input-suffix"},[e("i",{staticClass:"anticon anticon-close-circle ant-input-clear-icon"})])])])],1):t._e(),e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"客户级别"}},[e("a-select",{attrs:{allowClear:"",placeholder:"请选择客户级别"},model:{value:t.queryParam.level,callback:function(e){t.$set(t.queryParam,"level",e)},expression:"queryParam.level"}},t._l(t.config.customConfig.level,(function(a,i){return e("a-select-option",{key:i,attrs:{value:a.value}},[t._v(t._s(a.key)+" ")])})),1)],1)],1),e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"跟进状态"}},[e("a-select",{attrs:{allowClear:"",placeholder:"请选择跟进状态"},model:{value:t.queryParam.status,callback:function(e){t.$set(t.queryParam,"status",e)},expression:"queryParam.status"}},t._l(t.getFollowStatusList,(function(a,i){return e("a-select-option",{key:i,attrs:{value:a.value}},[t._v(t._s(a.key)+" ")])})),1)],1)],1),e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"客户星级"}},[e("a-select",{attrs:{allowClear:"",placeholder:"请选择客户星级"},model:{value:t.queryParam.starList,callback:function(e){t.$set(t.queryParam,"starList",e)},expression:"queryParam.starList"}},t._l(t.config.customConfig.star,(function(a,i){return e("a-select-option",{key:i,attrs:{value:a.value}},[t._v(t._s(a.key)+" ")])})),1)],1)],1),e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"客户来源"}},[e("a-select",{attrs:{allowClear:"",placeholder:"请选择客户来源"},model:{value:t.queryParam.sourceList,callback:function(e){t.$set(t.queryParam,"sourceList",e)},expression:"queryParam.sourceList"}},t._l(t.config.customConfig.resources,(function(a,i){return e("a-select-option",{key:i,attrs:{value:a.value}},[t._v(t._s(a.key)+" ")])})),1)],1)],1),e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"生日月份"}},[e("a-select",{attrs:{allowClear:"",placeholder:"请选择生日月份"},model:{value:t.queryParam.birthday,callback:function(e){t.$set(t.queryParam,"birthday",e)},expression:"queryParam.birthday"}},t._l(t.config.monthConfig,(function(a,i){return e("a-select-option",{key:i,attrs:{value:a.value}},[t._v(t._s(a.key)+" ")])})),1)],1)],1),e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"添加日期"}},[e("a-range-picker",{attrs:{placeholder:["选择开始时间","选择结束时间"]},on:{change:t.createDateChange},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)],1)],1)],1)],1),e("div",{staticClass:"table-operator row"},[e("a-button",{staticStyle:{width:"240px"},attrs:{type:"primary"},on:{click:t.getData}},[t._v("搜索 ")]),e("a-button",{staticStyle:{"margin-left":"20px"},on:{click:t.reset}},[t._v("重置")]),t.json_data.length>0?e("download-excel",{attrs:{data:t.json_data,fields:t.json_fields,type:"csv",worksheet:"My Worksheet",name:"客户列表.xls"}},[e("a-button",{staticClass:"marginLeft20",attrs:{type:"primary"}},[t._v("导出到表格")])],1):t._e()],1),t._l(t.data,(function(a,i){return e("div",{key:i},[e("div",{staticClass:"header row space-between"},[e("div",[t._v(" "+t._s("客户姓名："+a.name+"      联系电话："+a.phone+"      客户星级："+a.star+"星")+" ")]),e("div",[t._v(" 创建时间："+t._s(t._f("dateChina")(a.createTime))+" ")])]),e("div",{staticClass:"row fill"},[e("div",{staticClass:"fill"},[e("div",[t._v("客户级别："+t._s(a.level)+"级")]),e("div",[t._v("身份证号："+t._s(t._f("formatStr")(a.idNum)))]),t.permissionCustomView?e("div",[t._v("归属员工："+t._s(t.getBelongInfo(a)))]):t._e(),e("div",[t._v("客户来源："+t._s(t._f("source")(a.source)))]),e("div",[t._v("客户生日："+t._s(t._f("dateChina")(a.birthday)))]),e("div",[t._v("创建日期："+t._s(t._f("dateChina")(a.createTime)))])]),e("div",{staticClass:"split"}),e("div",{staticClass:"fill"},[e("div",[t._v("客户积分："+t._s(t._f("formatStr")(a.score,0)))]),e("div",[t._v("所属城市："+t._s(t.getCityInfo(a)))]),e("div",[t._v("交强险到期："+t._s(t._f("yearMonth")(a.compulsoryInsuranceExpirationDate)))]),e("div",[t._v("商业险到期："+t._s(t._f("yearMonth")(a.commercialInsuranceExpirationDate)))]),e("div",[t._v("年审到期："+t._s(t._f("yearMonth")(a.annualReviewExpirationDate)))]),e("div",[t._v("保养到期："+t._s(t._f("yearMonth")(a.maintainExpirationDate)))])]),e("div",{staticClass:"split"}),e("div",{staticClass:"fill"},[t.showFollow(a)?e("div",[t._v("跟进状态："+t._s(t._f("followStatus")(a.followUpList[0].status))+" ")]):t._e(),t.showFollow(a)?e("div",[t._v("跟进状态："+t._s(t._f("dateChina")(a.followUpList[0].followTime))+" ")]):t._e(),t.showFollow(a)?e("div",[t._v("跟进状态："+t._s(t._f("dateChina")(a.followUpList[0].nextTime))+" ")]):t._e(),t.showFollow(a)?t._e():e("div",{staticClass:"no-data center"},[t._v("暂无跟进")])]),e("div",{staticClass:"split"}),e("div",{staticClass:"fill"},[t.showIntention(a)?e("div",[t._v("意向类型："+t._s(t._f("intentionType")(a.intentionList[0].type))+" ")]):t._e(),t.showIntention(a)?e("div",[t._v(" "+t._s(1===a.intentionList[0].type?"出售车型":"意向车型")+"："+t._s(t.formatIntentionCar(a.intentionList[0]))+" ")]):t._e(),t.showIntention(a)?e("div",[t._v(" "+t._s(1===a.intentionList[0].type?"出售价格":"预算")+"："+t._s(t._f("price")(a.intentionList[0].price))+"万元 ")]):t._e(),t.showIntention(a)?t._e():e("div",{staticClass:"no-data center"},[t._v("暂无意向")])]),e("div",{staticClass:"split"}),e("div",{staticClass:"fill center column"},[e("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleDetail(a)}}},[t._v("查看详情")])],1)])])})),0===t.data.length?e("div",{staticClass:"no-data center"},[t._v(" 暂无数据 ")]):t._e(),e("div",{staticClass:"center marginTop20"},[t.total>0?e("a-pagination",{attrs:{total:t.total},on:{change:t.changePage,showSizeChange:t.showSizeChange},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}}):t._e()],1)],2),t.staffVisible?e("select-staff",{attrs:{visible:t.staffVisible},on:{ok:t.onSelectStaff,cancel:t.onCloseStaff}}):t._e(),e("custom-detail",{attrs:{data:t.detailData,visible:t.detailVisible},on:{cancel:t.cancelDetail}})],1)},s=[],n=a(68800),r=(a(21249),a(56977),a(42671)),l=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:"客户详情",width:1200,visible:t.visible,footer:null,destroyOnClose:""},on:{ok:function(){t.$emit("ok")},cancel:function(){t.$emit("cancel")}}},[e("a-card",{attrs:{"body-style":{padding:"24px 32px"},bordered:!1}},[e("a-descriptions",{attrs:{title:"基本信息",column:2}},[e("a-descriptions-item",{attrs:{label:"客户姓名",labelStyle:{fontWeight:"bold"}}},[t._v(" "+t._s(t._f("formatStr")(t.data.name))+" ")]),e("a-descriptions-item",{attrs:{label:"客户来源"}},[t._v(t._s(t._f("source")(t.data.source)))]),e("a-descriptions-item",{attrs:{label:"联系电话"}},[t._v(t._s(t._f("formatStr")(t.data.phone)))]),e("a-descriptions-item",{attrs:{label:"所属城市"}},[t._v(t._s(t.getCityInfo(t.data)))]),e("a-descriptions-item",{attrs:{label:"身份证号"}},[t._v(t._s(t._f("formatStr")(t.data.idNum)))]),e("a-descriptions-item",{attrs:{label:"客户生日"}},[t._v(t._s(t._f("dateChina")(t.data.birthday)))]),e("a-descriptions-item",{attrs:{label:"客户级别"}},[t._v(t._s(t._f("formatStr")(t.data.level))+"级")]),e("a-descriptions-item",{attrs:{label:"交强险到期"}},[t._v(" "+t._s(t._f("dateChina")(t.data.compulsoryInsuranceExpirationDate))+" ")]),e("a-descriptions-item",{attrs:{label:"客户星级"}},[t._v(t._s(t._f("formatStr")(t.data.star))+"星")]),e("a-descriptions-item",{attrs:{label:"商业险到期"}},[t._v(" "+t._s(t._f("dateChina")(t.data.commercialInsuranceExpirationDate))+" ")]),e("a-descriptions-item",{attrs:{label:"客户积分"}},[t._v(t._s(t._f("formatStr")(t.data.score,0)))]),e("a-descriptions-item",{attrs:{label:"年审到期"}},[t._v(t._s(t._f("dateChina")(t.data.annualReviewExpirationDate))+" ")]),t.permissionCustomView?e("a-descriptions-item",{attrs:{label:"归属员工"}},[t._v(t._s(t.getBelongInfo(t.data)))]):t._e(),e("a-descriptions-item",{attrs:{label:"保养到期"}},[t._v(t._s(t._f("dateChina")(t.data.maintainExpirationDate))+" ")])],1),e("a-divider",{staticStyle:{"margin-bottom":"32px"}}),e("a-descriptions",{attrs:{title:"跟进信息",column:2}},t._l(t.data.followUpList,(function(a,i){return e("div",{key:i},[e("div",{staticClass:"title"},[t._v("跟进"+t._s(i+1))]),e("div",{staticClass:"wrap"},[e("div",{staticClass:"row item"},[e("div",{staticClass:"title"},[t._v("跟进状态：")]),e("div",[t._v(t._s(t._f("followStatus")(a.status)))])]),e("a-divider",{staticStyle:{margin:"0!important"}}),e("div",{staticClass:"row item"},[e("div",{staticClass:"title"},[t._v("跟进时间：")]),e("div",[t._v(t._s(a.followTime))])]),e("a-divider",{staticStyle:{margin:"0!important"}}),e("div",{staticClass:"row item"},[e("div",{staticClass:"title"},[t._v("下次跟进时间：")]),e("div",[t._v(t._s(a.nextTime))])]),e("a-divider",{staticStyle:{margin:"0!important"}}),e("div",{staticClass:"row item"},[e("div",[t._v(t._s(t._f("formatStr")(a.remark)))])])],1)])})),0),e("a-divider",{staticStyle:{"margin-bottom":"32px"}}),e("a-descriptions",{attrs:{title:"意向信息",column:2}},[t.data.intentionList&&0!==t.data.intentionList.length?t._e():e("div",[e("span",{staticClass:"no-data center"},[t._v("暂无意向")])]),t._l(t.data.intentionList,(function(a,i){return t.data.intentionList&&t.data.intentionList.length>0?e("div",{key:i},[e("div",{staticClass:"title"},[t._v("意向"+t._s(i+1))]),e("div",{staticClass:"wrap"},[e("div",{staticClass:"row item"},[e("div",{staticClass:"title"},[t._v("创建日期：")]),e("div",[t._v(t._s(t._f("dateChina")(a.createTime)))])]),e("a-divider",{staticStyle:{margin:"0!important"}}),e("div",{staticClass:"row item"},[e("div",{staticClass:"title"},[t._v("意向类型：")]),e("div",[t._v(t._s(t._f("intentionType")(a.type)))])]),e("a-divider",{staticStyle:{margin:"0!important"}}),e("div",{staticClass:"row item"},[e("div",{staticClass:"title"},[t._v(t._s(1===a.type?"出售车型":"意向车型")+"：")]),e("div",[t._v(t._s(t.formatIntentionCar(a)))])]),e("a-divider",{staticStyle:{margin:"0!important"}}),e("div",{staticClass:"row item"},[e("div",{staticClass:"title"},[t._v(t._s(1===a.type?"出售价格":"价格预算")+"：")]),e("div",[t._v(t._s(t._f("price")(a.price))+"万元")])])],1)]):t._e()}))],2)],1)],1)},o=[],c={props:{visible:{type:Boolean,required:!0},data:{type:Object,required:!0}},components:{},data:function(){return{}},computed:{permissionCustomView:function(){return this.$store.getters.permissionCustomView}},methods:{getCityInfo:function(t){if(t.cityInfo&&t.cityInfo.province){var e=t.cityInfo,a=e.province,i=e.city;return a+"/"+i}return""},getBelongInfo:function(t){return t.belongTo&&t.belongTo.name?t.belongTo.name:""},formatIntentionCar:function(t){var e=0===t.type?"不限车型":"";return t.brandId&&(e=t.brandName,t.seriesName&&(e+="/"+t.seriesName),t.carName&&(e+="/"+t.carName)),e}},created:function(){}},u=c,f=a(1001),d=(0,f.Z)(u,l,o,!1,null,"88829924",null),m=d.exports,v=a(65163),_={CustomList:"/custom-list"};function p(t){return(0,v.ZP)({url:_.CustomList,method:"get",params:t})}var h=a(29698),g={name:"SellList",components:{STable:r.m7,Ellipsis:r.mH,SelectStaff:r.FF,customDetail:m},data:function(){var t=this;return this.config=h.Z,{queryParam:{},data:{},page:1,size:10,total:0,staffVisible:!1,date:null,json_fields:{"客户姓名":"name","联系电话":"phone","客户来源":{field:"source",callback:function(t){var e="";return h.Z.customConfig.resources.map((function(a){a.value===t&&(e=a.key)})),e}},"所属城市":{field:"cityInfo",callback:function(t){if(t&&t.province){var e=t.province,a=t.city;return e+"/"+a}return""}},"身份证号":"idNum","客户生日":{field:"birthday",callback:function(t){if(!t)return"";t.length>10&&(t=t.substring(0,10));var e=t.split("-");return e[0]+"年"+e[1]+"月"+e[2]+"日"}},"客户级别":{field:"level",callback:function(t){return t+"级"}},"客户积分":"score","客户星级":{field:"star",callback:function(t){return t+"星"}},"归属员工":{field:"belongTo",callback:function(t){return t&&t.name?t.name:""}},"交强险日期":{field:"compulsoryInsuranceExpirationDate",callback:function(t){if(!t)return"";t.length>10&&(t=t.substring(0,10));var e=t.split("-");return e[0]+"年"+e[1]+"月"}},"商业险日期":{field:"commercialInsuranceExpirationDate",callback:function(t){if(!t)return"";t.length>10&&(t=t.substring(0,10));var e=t.split("-");return e[0]+"年"+e[1]+"月"}},"年审日期":{field:"annualReviewExpirationDate",callback:function(t){if(!t)return"";t.length>10&&(t=t.substring(0,10));var e=t.split("-");return e[0]+"年"+e[1]+"月"}},"保养到期":{field:"maintainExpirationDate",callback:function(t){if(!t)return"";t.length>10&&(t=t.substring(0,10));var e=t.split("-");return e[0]+"年"+e[1]+"月"}},"跟进状态":{field:"followUpList",callback:function(e){var a,i;if(!e||0===e.length)return"";var s=e[0].status,n="";return null===(a=t.$store.getters.config)||void 0===a||null===(i=a.followConfigList)||void 0===i||i.map((function(t){t.value===s&&(n=t.key)})),n}},"跟进时间":{field:"followUpList",callback:function(t){if(!t||0===t.length)return"";var e=t[0].followTime;if(!e)return"";e.length>10&&(e=e.substring(0,10));var a=e.split("-");return a[0]+"年"+a[1]+"月"+a[2]+"日"}},"下次跟进时间":{field:"followUpList",callback:function(t){if(!t||0===t.length)return"";var e=t[0].nextTime;if(!e)return"";e.length>10&&(e=e.substring(0,10));var a=e.split("-");return a[0]+"年"+a[1]+"月"+a[2]+"日"}},"跟进备注":{field:"followUpList",callback:function(t){if(!t||0===t.length)return"";var e=t[0].remark;return e||""}},"意向日期":{field:"intentionList",callback:function(t){if(!t||0===t.length)return"";var e=t[0].createTime;if(!e)return"";e.length>10&&(e=e.substring(0,10));var a=e.split("-");return a[0]+"年"+a[1]+"月"+a[2]+"日"}},"意向类型":{field:"intentionList",callback:function(t){if(!t||0===t.length)return"";var e=t[0].type,a="";return h.Z.customConfig.intentionConfig.type.map((function(t){t.value===e&&(a=t.key)})),a}},"意向车型":{field:"intentionList",callback:function(t){if(!t||0===t.length)return"";var e=t[0],a=e.brandId,i=e.brandName,s=e.seriesId,n=e.seriesName,r=e.carId,l=e.carName,o="不限车型";return a&&(o=i,s&&(o+="/"+n),r&&(o+="/"+l)),o}},"价格预算":{field:"intentionList",callback:function(t){if(!t||0===t.length)return"";var e=t[0].price,a="0";return e&&(a=(parseFloat(e+"")/1e4).toFixed(2)),a+"万元"}},"创建日期":{field:"createTime",callback:function(t){if(!t)return"";t.length>10&&(t=t.substring(0,10));var e=t.split("-");return e[0]+"年"+e[1]+"月"+e[2]+"日"}}},json_data:[],detailData:{},detailVisible:!1}},created:function(){this.getData(),this.getFullData()},computed:{carStatus:function(){return this.$store.getters.config.carStatusConfigList},getFollowStatusList:function(){return this.$store.getters.config.followConfigList},getStaffName:function(){var t=this.queryParam.belongName;return t},permissionCustomView:function(){return this.$store.getters.permissionCustomView}},methods:{changePage:function(t,e){this.page=t,this.size=e,this.getData()},showSizeChange:function(t,e){this.page=t,this.size=e,this.getData()},handleDetail:function(t){this.detailData=t,this.detailVisible=!0},formatIntentionCar:function(t){var e=0===t.type?"不限车型":"";return t.brandId&&(e=t.brandName,t.seriesName&&(e+="/"+t.seriesName),t.carName&&(e+="/"+t.carName)),e},getBelongInfo:function(t){return t.belongTo&&t.belongTo.name?t.belongTo.name:""},getCityInfo:function(t){if(t.cityInfo&&t.cityInfo.province){var e=t.cityInfo,a=e.province,i=e.city;return a+"/"+i}return""},showFollow:function(t){return t.followUpList&&t.followUpList.length>0},showIntention:function(t){return t.intentionList&&t.intentionList.length>0},getData:function(){var t=this,e=this.page,a=this.size;p((0,n.Z)((0,n.Z)({belong:this.permissionCustomView?"":this.$store.getters.staff.userId},this.queryParam),{},{page:e,size:a})).then((function(e){var a=e.total,i=e.data;t.total=a,t.data=i}))},getFullData:function(){var t=this;p({belong:this.permissionCustomView?"":this.$store.getters.staff.userId,page:1,size:99999}).then((function(e){var a=e.data;t.json_data=a}))},createDateChange:function(t){console.log(t),this.date=t,t&&t.length>0?(this.queryParam.createTimeStart=t[0].format("YYYY-MM-DD"),this.queryParam.createTimeEnd=t[1].format("YYYY-MM-DD")):(this.queryParam.createTimeStart="",this.queryParam.createTimeEnd="")},onCloseStaff:function(){this.staffVisible=!1},cancelDetail:function(){this.detailVisible=!1},onSelectStaff:function(t){this.queryParam=(0,n.Z)((0,n.Z)({},this.queryParam),{},{belong:t.staffUserId,belongName:t.staffName}),this.onCloseStaff()},selectStaff:function(){this.staffVisible=!0},reset:function(){this.queryParam={},this.date=null}}},b=g,y=(0,f.Z)(b,i,s,!1,null,null,null),C=y.exports}}]);