(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59e8f24c"],{"1da1":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("d3b7");function n(t,e,a,n,i,r,s){try{var o=t[r](s),l=o.value}catch(c){return void a(c)}o.done?e(l):Promise.resolve(l).then(n,i)}function i(t){return function(){var e=this,a=arguments;return new Promise((function(i,r){var s=t.apply(e,a);function o(t){n(s,i,r,o,l,"next",t)}function l(t){n(s,i,r,o,l,"throw",t)}o(void 0)}))}}},2909:function(t,e,a){"use strict";a.d(e,"a",(function(){return l}));var n=a("6b75");function i(t){if(Array.isArray(t))return Object(n["a"])(t)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function r(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var s=a("06c5");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t){return i(t)||r(t)||Object(s["a"])(t)||o()}},"39fe":function(t,e,a){},4124:function(t,e,a){},7319:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("page-header-wrapper",[n("a-card",{attrs:{bordered:!1}},[n("div",{staticClass:"table-page-search-wrapper"},[n("a-form",{attrs:{layout:"inline"}},[n("a-row",{attrs:{gutter:48}},[n("a-col",{attrs:{md:8,sm:24}},[n("a-form-item",{attrs:{label:"内容标题"}},[n("a-input",{attrs:{placeholder:""},model:{value:e.queryParam.title,callback:function(t){e.$set(e.queryParam,"title",t)},expression:"queryParam.title"}})],1)],1),e.isNotVUser?n("a-col",{attrs:{md:8,sm:24}},[n("a-form-item",{attrs:{label:"所属大V"}},[n("div",{staticClass:"select-v",on:{click:e.selectVData}},[e._v(e._s(e.vData.name))])])],1):e._e(),e.advanced?[n("a-col",{attrs:{md:8,sm:24}},[n("a-form-item",{attrs:{label:"状态"}},[n("a-select",{attrs:{placeholder:"请选择状态"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}},[n("a-select-option",{attrs:{value:this.contentConfig.contentStatus.normal}},[e._v("正常")]),n("a-select-option",{attrs:{value:this.contentConfig.contentStatus.forbidden}},[e._v("禁用")])],1)],1)],1)]:e._e(),n("a-col",{attrs:{md:e.advanced?24:8,sm:24}},[n("span",{staticClass:"table-page-search-submitButtons",style:e.advanced&&{float:"right",overflow:"hidden"}||{}},[n("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),n("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){t.queryParam={},t.vData={name:""}}}},[e._v("重置")]),n("a",{staticStyle:{"margin-left":"8px"},on:{click:e.toggleAdvanced}},[e._v(" "+e._s(e.advanced?"收起":"展开")+" "),n("a-icon",{attrs:{type:e.advanced?"up":"down"}})],1)],1)])],2)],1)],1),n("div",{staticClass:"table-operator"},[n("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("新建")])],1),n("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,scroll:{x:!0},showPagination:"auto"},scopedSlots:e._u([{key:"pic",fn:function(t){return n("span",{},[n("img",{staticClass:"activity-pic",attrs:{src:t.url,alt:"活动图片"}})])}},{key:"status",fn:function(t){return n("span",{},[e._v(" "+e._s(e.getContentStatus(t.toString()))+" ")])}},{key:"des",fn:function(t){return n("span",{},[n("ellipsis",{attrs:{length:50,tooltip:""}},[e._v(" "+e._s(t)+" ")])],1)}},{key:"action",fn:function(t,a){return n("span",{},[[n("a",{on:{click:function(t){return e.edit(a)}}},[e._v("编辑")]),n("a-divider",{attrs:{type:"vertical"}}),n("a",{on:{click:function(t){return e.action(a)}}},[e._v(e._s(e.getActionStatus(a.status.toString())))])]],2)}}])}),n("select-v",{attrs:{visible:e.visible},on:{cancel:e.handleSelectVCancel,ok:e.handleSelectVOk}}),e.contentEditVisible?n("content-edit",{attrs:{visible:e.contentEditVisible,data:e.data},on:{cancel:e.handleEditContentCancel,ok:e.handleEditContentOk}}):e._e()],1)],1)},i=[],r=(a("d3b7"),a("25f0"),a("2af9")),s=a("0fea"),o=a("a754"),l=a("ca00"),c=a("a078"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:"编辑内容",width:1200,visible:t.visible,footer:null,destroyOnClose:""},on:{ok:function(){t.$emit("ok")},cancel:function(){t.$emit("cancel")}}},[a("a-card",{attrs:{"body-style":{padding:"24px 32px"},bordered:!1}},[a("a-form",{attrs:{form:t.form},on:{submit:t.handleSubmit}},[a("a-form-item",{attrs:{label:"内容标题",labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:17}}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{rules:[{required:!0,message:"请输入内容标题"}],initialValue:this.data.title}],expression:"[\n            'title',\n            {rules: [{ required: true, message: '请输入内容标题' }], initialValue: this.data.title}\n          ]"}],attrs:{placeholder:"内容标题"}})],1),t.isNotVUser?a("a-form-item",{attrs:{label:"关联大V",labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:17}}}},[a("div",{directives:[{name:"decorator",rawName:"v-decorator",value:["vId",{initialValue:this.data.vId}],expression:"[\n            'vId',\n            { initialValue: this.data.vId }\n          ]"}],staticClass:"select-v",attrs:{name:"vId"},on:{click:t.selectVData}},[t._v(t._s(t.vData.name))])]):t._e(),a("a-form-item",{staticClass:"avatar-uploader-container",attrs:{label:"封面图片",labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:17}}}},[a("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["pic",{rules:[{required:!0,message:"请选择封面图片"}],initialValue:this.data.pic.key}],expression:"[\n            'pic',\n            {rules: [{ required: true, message: '请选择封面图片' }], initialValue: this.data.pic.key}\n          ]"}],staticClass:"avatar-uploader",attrs:{name:"avatar","list-type":"picture-card","show-upload-list":!1,action:t.getUploadPic,data:t.getData,headers:{Authorization:"Bearer "+t.token},"before-upload":t.beforeUpload},on:{change:t.handleChange}},[t.pic?a("img",{staticClass:"pic",attrs:{src:t.pic,alt:"avatar"}}):a("div",[a("a-icon",{attrs:{type:t.loading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v(" 上传 ")])],1)]),a("span",{staticStyle:{color:"grey","line-height":"20px","font-size":"10px"}},[t._v("图片建议尺寸200*200px")])],1),a("a-form-item",{attrs:{label:"内容详情",labelCol:{lg:{span:7},sm:{span:7}},wrapperCol:{lg:{span:10},sm:{span:17}}}},[a("div",{directives:[{name:"decorator",rawName:"v-decorator",value:["des",{initialValue:this.data.des}],expression:"[\n            'des',\n            { initialValue: this.data.des }\n          ]"}]},[a("quill-editor",{attrs:{options:t.editorOption},on:{change:function(e){return t.onEditorChange(e)}},model:{value:t.des,callback:function(e){t.des=e},expression:"des"}})],1)]),a("a-form-item",{staticStyle:{"text-align":"center"},attrs:{wrapperCol:{span:24}}},[a("a-button",{attrs:{htmlType:"submit",type:"primary"}},[t._v(t._s(t.$t("form.basic-form.form.submit")))])],1)],1),a("select-v",{attrs:{visible:t.vModelVisible},on:{cancel:t.handleSelectVCancel,ok:t.handleSelectVOk}})],1)],1)},u=[],f=a("2909"),p=a("1da1"),v=a("5530"),m=(a("96cf"),a("d81d"),a("99af"),a("8096"),a("8ded")),h=a.n(m),b=a("9fb0"),g=a("953d"),y=a("7b4b");function w(t,e){var a=new FileReader;a.addEventListener("load",(function(){return e(a.result)})),a.readAsDataURL(t)}function V(t){return new Promise((function(e,a){var n=new FileReader;n.readAsDataURL(t),n.onload=function(){return e(n.result)},n.onerror=function(t){return a(t)}}))}g["Quill"].register("modules/ImageExtend",y["a"]);var C={props:{visible:{type:Boolean,required:!0},data:{type:Object,required:!0}},components:{SelectV:o["a"],quillEditor:g["quillEditor"]},data:function(){return{form:"",vData:{name:this.data.vname,vId:this.data.vId},previewVisible:!1,previewImage:"",fileList:[],vModelVisible:!1,token:h.a.get(b["a"]),loading:!1,pic:this.data.pic.url,des:"",isNotVUser:!Object(l["z"])(),editorOption:{modules:{ImageExtend:{loading:!0,name:"file",headers:function(t){t.setRequestHeader("Authorization","Bearer "+h.a.get(b["a"]))},action:"http:https://365house-admin.zenyee.cn/api/admin/vuser/file/pub_upload",response:function(t){return t.data.extra}},toolbar:{container:y["c"],handlers:{image:function(){y["b"].emit(this.quill.id)}}}}}}},methods:{handleSubmit:function(t){var e=this;t.preventDefault(),this.form.validateFields((function(t,a){if(!t){var n,i,r,o,c,d,u;if(a.pic.file)if(200!==(null===(c=a.pic)||void 0===c||null===(d=c.file)||void 0===d||null===(u=d.response)||void 0===u?void 0:u.code))return void e.$notification.error({message:"图片上传失败, 请重新上传"});var f=Object(v["a"])(Object(v["a"])({id:e.data.id,vId:a.vId||Object(l["t"])()},a),{},{pic:a.pic.file?null===(n=a.pic)||void 0===n||null===(i=n.file)||void 0===i||null===(r=i.response)||void 0===r||null===(o=r.data)||void 0===o?void 0:o.key:a.pic});Object(s["ib"])(f).then((function(t){e.$emit("ok"),e.$notification.success({message:"修改成功"})}))}}))},selectVData:function(t){t.preventDefault(),this.vModelVisible=!0},handleSelectVCancel:function(){this.vModelVisible=!1},getUploadPic:function(){return Object(l["s"])()},handleSelectVOk:function(t){this.vModelVisible=!1,null!==t&&void 0!==t&&""!==t&&(this.vData=t,this.form.setFieldsValue({vId:t.id}))},handleCancel:function(){this.previewVisible=!1},encodeHtml:function(t){var e="";if(""===t)return e;for(var a=0;a<t.length;a++)e+="&#"+t.substring(a,a+1).charCodeAt().toString(10)+";";return e},handlePreview:function(t){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.url||t.preview){a.next=4;break}return a.next=3,V(t.originFileObj);case 3:t.preview=a.sent;case 4:e.previewImage=t.url||t.preview,e.previewVisible=!0;case 6:case"end":return a.stop()}}),a)})))()},handleFileListChange:function(t){var e=t.fileList;this.fileList=e},handleChange:function(t){var e=this;"uploading"!==t.file.status?"done"===t.file.status&&w(t.file.originFileObj,(function(t){e.pic=t,e.loading=!1})):this.loading=!0},beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type;return e||this.$message.error("You can only upload JPG file!"),e},onEditorChange:function(t){this.des=t.html,this.form.setFieldsValue({des:t.html})},getData:function(t){return{file:t}}},created:function(){var t=this;setTimeout((function(){t.des=t.data.des}),500),this.form=this.$form.createForm(this),this.data.otherPic&&this.data.otherPic.map((function(e,a){t.fileList=[].concat(Object(f["a"])(t.fileList),[{uid:a,name:e.key,status:"done",url:e.url}])}))}},k=C,x=(a("b162"),a("2877")),S=Object(x["a"])(k,d,u,!1,null,"096934cf",null),O=S.exports,_=[{title:"内容id",dataIndex:"id"},{title:"所属大V",dataIndex:"vname"},{title:"内容标题",dataIndex:"title",width:"200px"},{title:"内容描述",dataIndex:"des",scopedSlots:{customRender:"des"}},{title:"封面图片",dataIndex:"pic",scopedSlots:{customRender:"pic"}},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"最近更新人",dataIndex:"updateUsername"},{title:"更新时间",dataIndex:"updateTime",sorter:!0},{title:"操作",dataIndex:"action",width:"150px",fixed:"right",scopedSlots:{customRender:"action"}}],I={name:"ActivityList",components:{STable:r["c"],Ellipsis:r["b"],SelectV:o["a"],ContentEdit:O},data:function(){var t=this;return this.columns=_,this.contentConfig=c["d"],{visible:!1,data:{},mdl:null,advanced:!1,vData:{name:""},isNotVUser:!Object(l["z"])(),contentEditVisible:!1,queryParam:{},loadData:function(e){var a=Object.assign({vId:Object(l["z"])()?Object(l["t"])():""},e,t.queryParam);return Object(s["L"])(a).then((function(t){return{data:t.data.list,total:t.data.total,page:a.page}}))}}},methods:{handleAdd:function(){this.$router.push("/content/create-content")},selectVData:function(t){t.preventDefault(),this.visible=!0},handleSelectVCancel:function(){this.visible=!1},handleEditContentCancel:function(){this.contentEditVisible=!1},handleEditContentOk:function(){this.contentEditVisible=!1,this.$refs.table.loadData()},handleSelectVOk:function(t){this.visible=!1,null!==t&&void 0!==t&&""!==t&&(this.vData=t,this.queryParam.vId=t.id)},getContentStatus:function(t){return Object(l["d"])(t)},edit:function(t){this.data=t,this.contentEditVisible=!0},toggleAdvanced:function(){this.advanced=!this.advanced},action:function(t){var e=this;t.status.toString()===c["d"].contentStatus.forbidden?Object(s["y"])(t.id).then((function(t){e.$refs.table.loadData()})):Object(s["qb"])(t.id).then((function(t){e.$refs.table.loadData()}))},getActionStatus:function(t){return t===c["d"].contentStatus.forbidden?"启用":"禁用"}}},j=I,D=(a("ff26"),Object(x["a"])(j,n,i,!1,null,null,null));e["default"]=D.exports},b162:function(t,e,a){"use strict";a("39fe")},ff26:function(t,e,a){"use strict";a("4124")}}]);